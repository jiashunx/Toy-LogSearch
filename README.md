### 小工具：Linux日志聚合检索工具（Go实现）

- 需求背景
   - 对一些小项目而言，可能并不具备给服务集群安装统一的日志收集监控系统的条件，每当需根据日志排查问题时，都要人工登陆一台台的服务器来检索日志，借助当前的日志检索工具充当客户端，可以以配置的方式来聚合查询所有指定服务器路径下的日志文件然后返回输出。

- 应用场景
   - 1、小项目，未安装统一的日志收集监控系统，微服务集群更适合，服务实例越多越适用越省事
   - 2、非常适合根据流水号、全局业务跟踪号等进行日志检索（确定的查询条件，但不知道具体在哪个服务器，就可以用此工具）

- 运行配置：
   - 1、下面是一个简单的config.json配置文件（与可执行文件同目录）
```json
{
  "servers": [
    {
      "ip": "192.168.138.1",
      "port": 22,
      "username": "jiashunx",
      "password": "1234.abcd"
    }
  ],
  "services": [
    {
      "env": "sit2",
      "service": "newcore",
      "configs": [
        {
          "ip": "192.168.138.1",
          "logPaths": [
            "/app/log/20*/file*",
            "/app/log/log.txt"
          ]
        }
      ]
    }
  ]
}
```
   - 2、可以从上面的配置中看到，配置信息主要分为两类：服务器配置、服务配置，服务配置包括环境、服务、服务器日志路径配置等
   - 3、当前日志检索工具实现是基于该配置文件实现（主要就是根据环境、服务、服务器日志路径配置等信息进行日志聚合检索）
   - 4、可执行文件运行环境：win64,linux
   - 5、可执行文件运行时参数：（x.exe arg1 arg2）
      - 1、arg1，指定监听地址及端口，非必输，默认值 :38888；
         - 指定当前日志检索工具监听端口（用于启动配置服务，提供 /config.json 接口，同步当前日志检索配置给其他日志检索工具实例）
      - 2、arg2，指定远程配置服务地址，非必输，默认为空；
         - 该参数为空时，日志检索工具实例从本地可执行文件同目录config.json配置文件读取配置
         - 该参数不为空时，日志检索工具实例从该服务同步日志检索配置（同时存储到本地config目录中作为备份）

- 程序支持的控制台命令：
   - 1、普通的查询命令（使用空格对查询条件进行分隔）
      - 格式：[env] [service] [condition1] [condition2]...[conditionN]（condition不可出现空格）
      - 样例：sit2 newcore 2023-03-19 17\:17\:17 202304181703222101000066
   - 2、grep命令（自定义grep语句）
      - 格式：[env] [service] grep [condition1] [condition2]...[conditionN]（condition可出现空格）
      - 样例：sit2 newcore grep 2023-03-19 | grep 17\:17\:17 | grep 202304181703222101000066
   - 3、bash命令（自定义bash语句）
      - 格式：[env] [service] bash [command1] [command2]...[commandN]（command可出现空格）
      - 样例：sit2 newcore bash cat /log/print.log | grep 2023-03-19 | grep 17\:17\:17 | grep 202304181703222101000066
   - 4、重新加载配置（从本地读取或从远程配置服务器读取配置信息并更新）
      - 格式：reload
      - 样例：reload
